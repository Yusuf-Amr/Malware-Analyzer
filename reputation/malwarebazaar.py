import requests
from reputation.reputation_base import ReputationBase
from reputation.api.config_loader import load_config

class MalwareBazaar(ReputationBase):
    def __init__(self):
        config = load_config()
        self.api_key = config['malware_bazaar']

    def get_reputation(self, file_hash):
        url = "https://mb-api.abuse.ch/api/v1/"
        data = {
            "query": "get_info",
            "hash": file_hash
        }
        headers = {
            "API-KEY": self.api_key
        }
        response = requests.post(url, headers=headers, data=data)
        return response.json()
