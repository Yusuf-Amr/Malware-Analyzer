import requests
from reputation.reputation_base import ReputationBase
from reputation.api.config_loader import load_config

class HybridAnalysis(ReputationBase):
    def __init__(self):
        config = load_config()
        self.api_key = config['hybrid_analysis']['api_key']

    def get_reputation(self, file_hash):
        url = f"https://www.hybrid-analysis.com/api/v2/search/hash/{file_hash}"
        headers = {
            "api-key": self.api_key,
            "user-agent": "Falcon Sandbox"
        }
        response = requests.get(url, headers=headers)
        return response.json()
