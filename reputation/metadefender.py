import requests
from reputation.reputation_base import ReputationBase
from reputation.api.config_loader import load_config

class Metadefender(ReputationBase):
    def __init__(self):
        config = load_config()
        self.api_key = config['metadefender']

    def get_reputation(self, file_hash):
        url = f"https://api.metadefender.com/v4/hash/{file_hash}"
        headers = {
            "apikey": self.api_key
        }
        response = requests.get(url, headers=headers)
        return response.json()
